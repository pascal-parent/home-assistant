title: "Home"
path: "home"
cards:
- type: vertical-stack
    cards:
      # ----------------------------------------------------------------------------
      # Electricity
      # ----------------------------------------------------------------------------
      - type: vertical-stack
        in_card: true
        cards:
          - type: "custom:button-card"
            template: custom_card_title
            name: Electricity
            card_mod:
              style: |
                ha-card {
                  margin-top: 15px;
                }

          # ----------------------------------------------------------------------------
          # Energy
          # ----------------------------------------------------------------------------
          - type: glance
            show_name: false
            entities:
              - entity: sensor.sunsynk_pv1_power
                name: Solar
                icon: mdi:solar-power
                tap_action:
                  action: navigate
                  navigation_path: "electricity"
              - entity: sensor.sunsynk_battery_soc
                name: Charge
                tap_action:
                  action: navigate
                  navigation_path: "electricity"
              - entity: sensor.sunsynk_battery_power
                name: Batteries
                icon: mdi:home-battery-outline
                tap_action:
                  action: navigate
                  navigation_path: "electricity"
              - entity: sensor.sunsynk_essential_power
                name: Essential
                icon: mdi:home-lightning-bolt
                tap_action:
                  action: navigate
                  navigation_path: "electricity"
              - entity: sensor.efergy_power_usage
                name: Grid
                icon: mdi:transmission-tower
                tap_action:
                  action: navigate
                  navigation_path: "electricity"

          # ----------------------------------------------------------------------------
          # Charging status
          # ----------------------------------------------------------------------------
          - type: markdown
            content: |
              {% set gp = states('sensor.sunsynk_grid_power') | float(0) %}
              {% set bp = states('sensor.sunsynk_battery_power') | float(0) %}
              {% if is_state('input_boolean.sunsynk_house_batteries_charging', 'on') %}
                {% if (gp > 50) %}
                  <ha-alert alert-type="error">Batteries Charging from Grid</ha-alert>
                {% else %}
                  <ha-alert alert-type="success">Batteries Charging from Solar Panels</ha-alert>
                {% endif %}
              {% else %}
                {% if (bp > 100) %}
                  <ha-alert alert-type="warning">On batteries</ha-alert>
                {% else %}
                  <ha-alert alert-type="error">On grid</ha-alert>
                {% endif %}
              {% endif %}
            card_mod:
              style: |
                ha-card {
                  margin-top: 10px;
                  margin-bottom: -10px;
                  background: #372A2900;
                }

          # ----------------------------------------------------------------------------
          # Load shedding and power issues
          # ----------------------------------------------------------------------------
          - type: custom:atomic-calendar-revive
            enableModeChange: true
            firstDayOfWeek: 1
            refreshInterval: 1800
            entities:
              - entity: calendar.loadshedding_local_events
                maxDaysToShow: 1
            showCurrentEventLine: false
            showMonth: false
            showWeekDay: true
            disableEventLink: true
            showNoEventsForToday: false
            disableLocationLink: true
            showFullDayProgress: false
            showEventIcon: false
            showHiddenText: false
            showCalendarName: false
            calShowDescription: false
            showLastCalendarWeek: true
            disableCalEventLink: true
            disableCalLocationLink: true
            disableCalLink: true
            showDescription: false
            dateFormat: LL
            showDate: false
            sortByStartTime: false
            showRelativeTime: true
            showProgressBar: true
            showLocation: true
            showDeclined: false
            showMultiDayEventParts: false
            showMultiDay: false
            showLoader: false
            maxEventCount: 1
            untilText: "Until"
            compactMode: false
            card_mod:
              style: |
                ha-card {
                  margin-top: 10px;
                }